<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DashTab - 导航扩展</title>
    <!-- 加载打包后的库 -->
    <link rel="stylesheet" href="libs/style.css">
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <!-- 加载状态 -->
    <div id="loading" class="loading-overlay">
        <div class="loading-spinner">
            <i class="icon icon-compass icon-spin"></i>
            <p>正在加载...</p>
        </div>
    </div>

    <!-- 网站主体 -->
    <div class="container">
        <!-- 头部区域 -->
        <div class="header">
            <div class="logo">
                <i class="icon icon-compass"></i> 
                <span>我的导航站</span>
            </div>
        </div>

        <!-- 搜索区域 -->
        <div class="search-container">
            <div class="search-form">
                <div class="search-engine">
                    <select id="search-engine">
                        <option value="google">Google</option>
                        <option value="baidu">百度</option>
                        <option value="bing">必应</option>
                        <option value="zhihu">知乎</option>
                        <option value="github">GitHub</option>
                    </select>
                </div>
                <div class="search-input">
                    <input type="text" id="search-input" placeholder="输入关键词进行搜索...">
                </div>
                <button class="search-btn" id="search-btn">
                    搜索
                </button>
            </div>
        </div>

        <!-- 时间和天气区域 -->
        <div class="time-container">
            <div class="time-weather-row">
                <div id="datetime">加载中...</div>
                <div id="weather" class="weather-info">
                    <span class="weather-icon">🌤️</span>
                    <span class="weather-temp">--°</span>
                    <span class="weather-desc">获取中...</span>
                </div>
            </div>
        </div>

        <!-- tab筛选栏 - 顶部显著位置 -->
        <div class="tag-filter-container">
            <!-- 最常访问tab - 置于首位 -->
            <div class="tag-filter" id="tag-filter">
                <div class="tag-tab active" data-group="all">全部</div>
                <div class="tag-tab" data-group="work">工作</div>
                <div class="tag-tab" data-group="study">学习</div>
                <div class="tag-tab" data-group="dev">开发</div>
                <div class="tag-tab" data-group="design">设计</div>
                <div class="tag-tab" data-group="life">生活</div>
                <div class="tag-tab" data-group="entertainment">娱乐</div>
            </div>
        </div>

        <!-- 网站展示区 -->
        <div class="sites-container">
            <!-- 所有网站区 -->
            <div class="all-sites-section">
                <div class="all-sites" id="all-sites">
                    <!-- 网站将通过JavaScript动态生成 -->
                </div>
            </div>

            <!-- 空状态 -->
            <div class="empty-state" id="empty-state">
                <i class="icon icon-bookmark" style="font-size: 48px; color: var(--text-secondary); margin-bottom: 20px;"></i>
                <h3>还没有添加任何网站</h3>
                <p>点击右下角的"+"按钮添加您的第一个网站</p>
            </div>
        </div>

        <!-- 分页控制 -->
        <div class="pagination-controls" id="pagination-controls" style="display: none;">
            <button class="page-btn" id="prev-page">
                <i class="icon icon-chevron-left"></i>
            </button>
            <span class="page-info">
                第 <span id="current-page">1</span> 页，共 <span id="total-pages">1</span> 页
            </span>
            <button class="page-btn" id="next-page">
                <i class="icon icon-chevron-right"></i>
            </button>
        </div>
    </div>

    <!-- 操作按钮 -->
    <div class="action-buttons">
        <div class="fab-btn settings" id="settings-btn" title="设置">
            设置
        </div>
        <div class="fab-btn add" id="add-site-btn" title="添加网站">
            添加
        </div>
    </div>

    <!-- 添加网站表单 - 美化版 -->
    <div class="modal" id="add-site-modal">
        <div class="modal-content add-site-modal">
            <div class="modal-header">
                <h3 class="modal-title">添加新网站</h3>
                <button class="close-btn" id="close-modal-btn">
                    <i class="icon icon-times"></i>
                </button>
            </div>
            <div class="form-container">
                <form id="add-site-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="site-name">网站名称 <span class="required">*</span></label>
                            <input type="text" id="site-name" placeholder="输入网站名称，不超过16字" maxlength="16" required>
                            <div class="error-message" id="name-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="site-url">网站地址 <span class="required">*</span></label>
                            <input type="text" id="site-url" placeholder="https://example.com" required>
                            <div class="error-message" id="url-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="site-color">图标颜色</label>
                            <div class="color-picker-modern">
                                <div class="color-grid">
                                    <div class="color-option active" data-color="#007aff" style="background-color: #007aff;" title="苹果蓝"></div>
                                    <div class="color-option" data-color="#5856d6" style="background-color: #5856d6;" title="紫色"></div>
                                    <div class="color-option" data-color="#af52de" style="background-color: #af52de;" title="紫红色"></div>
                                    <div class="color-option" data-color="#ff2d92" style="background-color: #ff2d92;" title="粉红色"></div>
                                    <div class="color-option" data-color="#ff3b30" style="background-color: #ff3b30;" title="红色"></div>
                                    <div class="color-option" data-color="#ff9500" style="background-color: #ff9500;" title="橙色"></div>
                                    <div class="color-option" data-color="#ffcc02" style="background-color: #ffcc02;" title="黄色"></div>
                                    <div class="color-option" data-color="#34c759" style="background-color: #34c759;" title="绿色"></div>
                                    <div class="color-option" data-color="#00c7be" style="background-color: #00c7be;" title="青绿色"></div>
                                    <div class="color-option" data-color="#5ac8fa" style="background-color: #5ac8fa;" title="天蓝色"></div>
                                    <div class="color-option" data-color="#8e8e93" style="background-color: #8e8e93;" title="灰色"></div>
                                    <div class="color-option" data-color="#1c1c1e" style="background-color: #1c1c1e;" title="深色"></div>
                                </div>
                                <input type="hidden" id="site-color" value="#007aff">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="site-tag">分类 <span class="required">*</span></label>
                            <div class="tag-input-container">
                                <select id="site-tag" class="modern-select" required>
                                    <option value="">请选择tab</option>
                                    <option value="work">工作</option>
                                    <option value="study">学习</option>
                                    <option value="dev">开发</option>
                                    <option value="design">设计</option>
                                    <option value="life">生活</option>
                                    <option value="entertainment">娱乐</option>
                                    <option value="custom">创建新分类...</option>
                                </select>
                                <input type="text" id="custom-tag-input" placeholder="输入新tab名称" style="display: none;" maxlength="10">
                            </div>
                            <div class="category-management-buttons">
                                <button type="button" class="modern-btn secondary" id="manage-categories-btn">
                                    管理分类
                                </button>
                                
                            </div>
                            <div class="error-message" id="tab-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" id="cancel-add-btn">取消</button>
                        <button type="submit" class="submit-btn" id="submit-site-btn">
                            保存网站
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 设置模态框 -->
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">设置</h3>
                <button class="close-btn" id="close-settings-btn">
                    <i class="icon icon-times"></i>
                </button>
            </div>
            <div class="settings-content">
                <!-- 外观设置 -->
                <div class="settings-section">
                    <h4 class="settings-section-title">外观设置</h4>
                    <div class="setting-item">
                        <div class="setting-label">
                            <label>主题模式</label>
                            <span class="setting-description">选择浅色或深色主题</span>
                        </div>
                        <div class="setting-control">
                            <select id="theme-select" class="modern-select">
                                <option value="auto">自动（跟随系统）</option>
                                <option value="light">浅色模式</option>
                                <option value="dark">深色模式</option>
                            </select>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <label>每行网站数量</label>
                            <span class="setting-description">调整网站图标的排列密度</span>
                        </div>
                        <div class="setting-control">
                            <select id="sites-per-row" class="modern-select">
                                <option value="4">4个</option>
                                <option value="5" selected>5个</option>
                                <option value="6">6个</option>
                                <option value="7">7个</option>
                                <option value="8">8个</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 搜索设置 -->
                <div class="settings-section">
                    <h4 class="settings-section-title">搜索设置</h4>
                    <div class="setting-item">
                        <div class="setting-label">
                            <label>搜索打开方式</label>
                            <span class="setting-description">选择搜索结果的打开方式</span>
                        </div>
                        <div class="setting-control">
                            <select id="search-open-mode" class="modern-select">
                                <option value="current">当前tab</option>
                                <option value="new">新tab</option>
                            </select>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <label>网站打开方式</label>
                            <span class="setting-description">选择点击网站图标的打开方式</span>
                        </div>
                        <div class="setting-control">
                            <select id="site-open-mode" class="modern-select">
                                <option value="current">当前tab</option>
                                <option value="new">新tab</option>
                            </select>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <label>搜索引擎管理</label>
                            <span class="setting-description">添加、编辑或删除搜索引擎</span>
                        </div>
                        <div class="setting-control">
                            <button class="modern-btn secondary" id="manage-search-engines">
                                管理搜索引擎
                            </button>
                        </div>
                    </div>
                </div>

                

                <!-- 数据管理 -->
                <div class="settings-section">
                    <h4 class="settings-section-title">数据管理</h4>
                    <div class="data-management-grid">
                        <button class="data-btn export" id="export-data">
                            <div class="data-btn-content">
                                <span class="data-btn-title">导出数据</span>
                                <span class="data-btn-desc">备份所有网站和设置</span>
                            </div>
                        </button>
                        <button class="data-btn import" id="import-data">
                            <div class="data-btn-content">
                                <span class="data-btn-title">导入数据</span>
                                <span class="data-btn-desc">恢复备份的数据</span>
                            </div>
                        </button>
                        <button class="data-btn danger" id="reset-data">
                            <div class="data-btn-content">
                                <span class="data-btn-title">重置数据</span>
                                <span class="data-btn-desc">清除所有数据</span>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 搜索引擎管理模态框 -->
    <div class="modal" id="search-engine-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">搜索引擎管理</h3>
                <button class="close-btn" id="close-search-engine-btn">
                    <i class="icon icon-times"></i>
                </button>
            </div>
            <div class="search-engine-content">
                <div class="search-engine-list" id="search-engine-list">
                    <!-- 搜索引擎列表将通过JavaScript动态生成 -->
                </div>
                <div class="add-search-engine">
                    <h4>添加新搜索引擎</h4>
                    <form id="add-search-engine-form">
                        <div class="form-group">
                            <label for="engine-name">搜索引擎名称 <span class="required">*</span></label>
                            <input type="text" id="engine-name" placeholder="例如：Google" required maxlength="20">
                        </div>
                        <div class="form-group">
                            <label for="engine-url">搜索URL <span class="required">*</span></label>
                            <input type="text" id="engine-url" placeholder="例如：https://www.google.com/search?q=%s" required>
                            <small class="form-help">使用 %s 作为搜索关键词的占位符</small>
                        </div>
                        <button type="submit" class="submit-btn">
                            添加搜索引擎
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 分类管理模态框 -->
    <div class="modal" id="category-management-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">分类管理</h3>
                <button class="close-btn" id="close-category-management-btn">
                    <i class="icon icon-times"></i>
                </button>
            </div>
            <div class="category-management-content">
                <div class="category-list-grid" id="category-list">
                    <!-- 分类列表将通过JavaScript动态生成 -->
                </div>
                <div class="add-category-section">
                    <button class="modern-btn primary" id="open-add-category-modal-btn">
                        <i class="icon icon-plus"></i> 添加新分类
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加新分类模态框 -->
    <div class="modal" id="add-category-modal">
        <div class="modal-content tag-picker-modal">
            <div class="modal-header">
                <h3 class="modal-title">添加新分类</h3>
                <button class="close-btn" id="close-add-category-modal-btn">
                    <i class="icon icon-times"></i>
                </button>
            </div>
            <form id="add-category-form">
                <div class="form-group">
                    <label for="add-category-name">分类名称 <span class="required">*</span></label>
                    <input type="text" id="add-category-name" placeholder="输入分类名称" required maxlength="10">
                    <div class="error-message" id="add-category-name-error"></div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="cancel-btn" id="cancel-add-category-btn">取消</button>
                    <button type="submit" class="submit-btn" id="submit-add-category-btn">
                        添加分类
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- 右键菜单 -->
    <div class="context-menu" id="context-menu" style="display: none;">
        <div class="context-item" id="edit-site">
            <i class="icon icon-edit"></i> 编辑
        </div>
        <div class="context-item" id="delete-site">
            <i class="icon icon-trash"></i> 删除
        </div>
        <div class="context-item" id="open-new-tab">
            <i class="icon icon-external-link"></i> 新tab打开
        </div>
    </div>

    <!-- 消息提示 -->
    <div class="toast" id="toast">
        <div class="toast-content">
            <i class="toast-icon icon icon-check-circle"></i>
            <span class="toast-message">操作成功！</span>
        </div>
    </div>

    <!-- 加载打包后的JavaScript库 -->
    <script src="libs/vendor.js"></script>
    <script src="libs/icons.js"></script>
    <script src="popup.js"></script>
</body>
</html>
